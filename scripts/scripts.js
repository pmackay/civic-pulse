(function(){"use strict";var a,b;a="http://www.codeforamerica.org/api",a="http://civicapi.herokuapp.com/api",b=angular.module("civicpulseApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","restangular","angularMoment","angular-loading-bar","infinite-scroll"]),b.config(["$httpProvider","RestangularProvider",function(a){return a.defaults.useXDomain=!0,delete a.defaults.headers.common["X-Requested-With"]}]),b.config(["$routeProvider","RestangularProvider",function(b,c){return b.when("/",{templateUrl:"views/activity.html",controller:"ActivityController"}).when("/activity",{templateUrl:"views/activity.html",controller:"ActivityController"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/orgs",{templateUrl:"views/orgs.html",controller:"OrgsController"}).otherwise({redirectTo:"/"}),c.setBaseUrl(a)}])}).call(this),function(){var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}};a=20,b=angular.module("civicpulseApp"),b.config(["RestangularProvider",function(a){return a.addResponseInterceptor(function(a,b,c,d){var e;return e=a,"getList"===b&&(e=a.objects),/projects/.test(d)&&(e.total=a.total),console.log("extractedData"),console.log(e),e})}]),c=function(a){var b,c,d;return d=a.last_updated.replace(" GMT",""),a.last_updated=moment(d,"ddd, D MMM YYYY HH:mm:ss").format("X"),a.github_details&&(b=moment(a.github_details.created_at),c=moment().diff(b),2592e6>c)?a.is_recent=!0:void 0},b.factory("CivicService",["$timeout","$http","Restangular","$rootScope",function(b,e,f){var g;return new(g=function(){function b(){this.fetchProjects=d(this.fetchProjects,this),this.collateLanguages=d(this.collateLanguages,this),this.projects=[],this.projectsTotal=0,this.page=1,this.languages=[]}return b.prototype.collateLanguages=function(){var a,b,c,d,e,f,g,h,i;for(this.languagesHash={},console.log("collateLanguages"),console.log(this),g=this.projects,e=0,f=g.length;f>e;e++)c=g[e],b=c.github_details.language,(void 0===b||null===b||""===b||"null"===b)&&(b="Unknown",c.github_details.language="Unknown"),void 0===this.languagesHash[b]?this.languagesHash[b]={name:b,total:1}:this.languagesHash[b].total+=1;this.languages=[],h=this.languagesHash,i=[];for(a in h)d=h[a],i.push(this.languages.push(d));return i},b.prototype.fetchProjects=function(){var b;return 0===this.projects.length||this.projects.length<this.projectsTotal?(console.log("fetchProjects"),b=f.all("projects").getList({per_page:a,page:this.page}),this.page+=1,b.then(function(a){return function(b){var d,e,f;for(console.log("gotProjects"),e=0,f=b.length;f>e;e++)d=b[e],c(d),a.projects.push(d);return a.projectsTotal=b.total,console.log(a.projectsTotal),console.log(a.projects.length),console.log(a.page),a.collateLanguages()}}(this))):void 0},b.prototype.organizations=function(){var a;return a=f.all("organizations").getList({per_page:1e3}),a.then(function(a){var b,d,e,f,g;for(g=[],e=0,f=a.length;f>e;e++)b=a[e],g.push(function(){var a,e,f,g;for(f=b.current_projects,g=[],a=0,e=f.length;e>a;a++)d=f[a],g.push(c(d));return g}());return g}),a},b}())}])}.call(this),function(){"use strict";var a;a=angular.module("civicpulseApp"),a.controller("ActivityController",["$scope","$rootScope","CivicService",function(a,b,c){return a.languageFilterSelected=function(b){return console.log(b),a.languageFilter=b},a.getProjectVisibility=function(b){return a.newProjectsValue&&!b.is_recent||""!==a.languageFilter&&a.languageFilter!==b.github_details.language},a.resetFilters=function(){return a.query="",a.languageFilter="",a.newProjectsValue=!1},a.paginateProjects=function(){return console.log("paginateProjects"),b.civicService.fetchProjects()},b.activeTab="activity",a.languageFilter="",console.log("ActivityController "+a.projects),void 0===b.civicService?(b.civicService=c,a.newProjectsValue=!1):void 0}]),a.controller("OrgsController",["$scope","$rootScope","CivicService",function(a,b,c){var d;return b.activeTab="orgs",void 0===b.organizations?(d=c.organizations(),d.then(function(a){return b.organizations=a})):void 0}])}.call(this);